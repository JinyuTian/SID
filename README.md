# Detecting Adversarial Examples from Sensitivity Inconsistency of Spatial-Transform Domain


## Preliminaries

* Pytorch
* pywt (pip install PyWavelets)

## Datasets

* CIFAR-10, SVHN


### 0. Train Dual model:
	TrainDualModel.py
	Pretrained primal and dual models for testing have been placed in the directory: `./pre_trained/`.
	python TrainDualModel.py --dataset=cifar10 --net_type=resnet --lr=1e-6 --wd=0.005
	
### 1. Prepare correctly classified imags, the correspodning adversarial examples and natural noise examples:
	ADV_Samples.py
	The produced examples for testing have been placed in `./adv_output/resnet_cifar10_BIM`.
	python ADV_Samples.py --dataset=cifar10 --net_type=resnet --adv_type=BIM --adv_parameter=0.006

### 2. Train SID over datasource generated by ADV_Samples
	KnownAttack.py
	A pretrained SID on source (resnet_cifar10_BIM_0.48) have been placed in `./ExperimentRecord/KnownAttack/resnet_cifar10_BIM_0.49`.
	python KnownAttack.py --dataset=cifar10 --net_type=resnet --adv_type=BIM 
	
### 3. Validate generalizability of SID (Train SID on different sources first, i.e. implement KnownAttack on different sources generated by ADV_Samples)
	TransferAttack.py


